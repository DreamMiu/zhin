import{_ as s,o as n,c as a,Q as l}from"./chunks/framework.c610f10c.js";const g=JSON.parse('{"title":"上下文(Context)","description":"","frontmatter":{},"headers":[],"relativePath":"api/context.md","filePath":"api/context.md","lastUpdated":1695345871000}'),o={name:"api/context.md"},e=l(`<h1 id="上下文-context" tabindex="-1">上下文(Context) <a class="header-anchor" href="#上下文-context" aria-label="Permalink to &quot;上下文(Context)&quot;">​</a></h1><div class="tip custom-block"><p class="custom-block-title">继承自 EventEmitter :::</p><h2 id="属性-attrs" tabindex="-1">属性(Attrs) <a class="header-anchor" href="#属性-attrs" aria-label="Permalink to &quot;属性(Attrs)&quot;">​</a></h2><h3 id="plugins-map-string-plugin" tabindex="-1">plugins:Map&lt;string,Plugin&gt; <a class="header-anchor" href="#plugins-map-string-plugin" aria-label="Permalink to &quot;plugins:Map&lt;string,Plugin&gt;&quot;">​</a></h3><ul><li><strong>当前</strong>上下文安装的插件Map</li></ul><h3 id="middlewares-middleware" tabindex="-1">middlewares:Middleware[] <a class="header-anchor" href="#middlewares-middleware" aria-label="Permalink to &quot;middlewares:Middleware[]&quot;">​</a></h3><ul><li><strong>当前</strong>上下文产生的所有中间件</li></ul><h3 id="components-record-string-component" tabindex="-1">components:Record&lt;string,Component&gt; <a class="header-anchor" href="#components-record-string-component" aria-label="Permalink to &quot;components:Record&lt;string,Component&gt;&quot;">​</a></h3><ul><li><strong>当前</strong>上下文产生的组件键值对</li></ul><h3 id="commands-map-string-command" tabindex="-1">commands:Map&lt;string,Command&gt; <a class="header-anchor" href="#commands-map-string-command" aria-label="Permalink to &quot;commands:Map&lt;string,Command&gt;&quot;">​</a></h3><ul><li><strong>当前</strong>上下文产生的指令Map</li></ul><h3 id="disposes-dispose" tabindex="-1">disposes:Dispose[] <a class="header-anchor" href="#disposes-dispose" aria-label="Permalink to &quot;disposes:Dispose[]&quot;">​</a></h3><ul><li>卸载<strong>当前</strong>上下文时，需要执行的函数列表</li></ul><h3 id="get-pluginlist-plugin" tabindex="-1">get pluginList:Plugin[] <a class="header-anchor" href="#get-pluginlist-plugin" aria-label="Permalink to &quot;get pluginList:Plugin[]&quot;">​</a></h3><ul><li>获取<strong>当前</strong>上下文及<strong>其下级</strong>上下文安装的插件列表</li></ul><h3 id="get-middlewarelist-middleware" tabindex="-1">get middlewareList:Middleware[] <a class="header-anchor" href="#get-middlewarelist-middleware" aria-label="Permalink to &quot;get middlewareList:Middleware[]&quot;">​</a></h3><ul><li>获取<strong>当前</strong>上下文及<strong>其下级</strong>上下文产生的的中间件列表</li></ul><h3 id="get-commandlist-command" tabindex="-1">get commandList:Command[] <a class="header-anchor" href="#get-commandlist-command" aria-label="Permalink to &quot;get commandList:Command[]&quot;">​</a></h3><ul><li>获取<strong>当前</strong>上下文及<strong>其下级</strong>上下文产生的的指令列表</li></ul><h3 id="context-childkey-context" tabindex="-1">[Context.childKey]:Context[] <a class="header-anchor" href="#context-childkey-context" aria-label="Permalink to &quot;[Context.childKey]:Context[]&quot;">​</a></h3><ul><li><strong>当前</strong>上下文产生的<strong>子</strong>上下文列表</li></ul><h3 id="context-plugin-plugin" tabindex="-1">[Context.plugin]:Plugin <a class="header-anchor" href="#context-plugin-plugin" aria-label="Permalink to &quot;[Context.plugin]:Plugin&quot;">​</a></h3><ul><li>产生<strong>当前</strong>上下文的插件</li></ul><h3 id="keyof-zhin-services-service" tabindex="-1">[keyof Zhin.Services]:Service <a class="header-anchor" href="#keyof-zhin-services-service" aria-label="Permalink to &quot;[keyof Zhin.Services]:Service&quot;">​</a></h3><ul><li>知音安装的服务</li></ul><h2 id="构造函数-constructor-public-parent-context-filter-filter" tabindex="-1">构造函数 constructor(public parent:Context,filter?:Filter) <a class="header-anchor" href="#构造函数-constructor-public-parent-context-filter-filter" aria-label="Permalink to &quot;构造函数 constructor(public parent:Context,filter?:Filter)&quot;">​</a></h2><h2 id="方法-methods" tabindex="-1">方法(Methods) <a class="header-anchor" href="#方法-methods" aria-label="Permalink to &quot;方法(Methods)&quot;">​</a></h2><h3 id="extend-ctx-context-context" tabindex="-1">extend(ctx:Context):Context <a class="header-anchor" href="#extend-ctx-context-context" aria-label="Permalink to &quot;extend(ctx:Context):Context&quot;">​</a></h3><ul><li>将<strong>其他</strong>上下文继承到<strong>当前</strong>上下文</li></ul><h3 id="pick-key-k-values-session-k-context" tabindex="-1">pick(key: K, ...values: Session[K][]):Context <a class="header-anchor" href="#pick-key-k-values-session-k-context" aria-label="Permalink to &quot;pick(key: K, ...values: Session[K][]):Context&quot;">​</a></h3><ul><li>产生一个新的上下文，该上下文仅在传入会话<code>session[key]</code>的值存在于<code>values</code>中并且 满足构造函数的filter时有效</li></ul><h3 id="union-filter-filter-context" tabindex="-1">union(filter:Filter):Context <a class="header-anchor" href="#union-filter-filter-context" aria-label="Permalink to &quot;union(filter:Filter):Context&quot;">​</a></h3><ul><li>产生一个新的上下文，该上下文仅在满足传入filter并且满足构造函数的filter时有效</li></ul><h3 id="except-filter-filter-context" tabindex="-1">except(filter:Filter):Context <a class="header-anchor" href="#except-filter-filter-context" aria-label="Permalink to &quot;except(filter:Filter):Context&quot;">​</a></h3><ul><li>产生一个新的上下文，该上下文仅在不满足传入filter并且满足构造函数的filter时有效</li></ul><h3 id="user-user-ids-string-number-context" tabindex="-1">user(...user_ids:(string|number)[]):Context <a class="header-anchor" href="#user-user-ids-string-number-context" aria-label="Permalink to &quot;user(...user_ids:(string|number)[]):Context&quot;">​</a></h3><ul><li>产生一个新的上下文，该上下文传入会话<code>session.user_id</code>的值存在于<code>user_ids</code>中并 且满足构造函数的filter时有效</li></ul><h3 id="group-group-ids-string-number-context" tabindex="-1">group(...group_ids:(string|number)[]):Context <a class="header-anchor" href="#group-group-ids-string-number-context" aria-label="Permalink to &quot;group(...group_ids:(string|number)[]):Context&quot;">​</a></h3><ul><li>产生一个新的上下文，该上下文传入会话<code>session.group_id</code>的值存在于<code>group_ids</code>中 并且满足构造函数的filter时有效</li></ul><h3 id="discuss-discuss-ids-string-number-context" tabindex="-1">discuss(...discuss_ids:(string|number)[]):Context <a class="header-anchor" href="#discuss-discuss-ids-string-number-context" aria-label="Permalink to &quot;discuss(...discuss_ids:(string|number)[]):Context&quot;">​</a></h3><ul><li>产生一个新的上下文，该上下文传入会话<code>session.discuss_id</code>的值存在 于<code>discuss_ids</code>中并且满足构造函数的filter时有效</li></ul><h3 id="guild-guild-ids-string-context" tabindex="-1">guild(...guild_ids:string[]):Context <a class="header-anchor" href="#guild-guild-ids-string-context" aria-label="Permalink to &quot;guild(...guild_ids:string[]):Context&quot;">​</a></h3><ul><li>产生一个新的上下文，该上下文传入会话<code>session.guild_id</code>的值存在于<code>guild_ids</code>中 并且满足构造函数的filter时有效</li></ul><h3 id="channel-channel-ids-string-context" tabindex="-1">channel(...channel_ids:string[]):Context <a class="header-anchor" href="#channel-channel-ids-string-context" aria-label="Permalink to &quot;channel(...channel_ids:string[]):Context&quot;">​</a></h3><ul><li>产生一个新的上下文，该上下文传入会话<code>session.channel_id</code>的值存在 于<code>channel_ids</code>中并且满足构造函数的filter时有效</li></ul><h3 id="platform-platforms-keyof-zhin-adapters-context" tabindex="-1">platform(...platforms:(keyof Zhin.Adapters)[]):Context <a class="header-anchor" href="#platform-platforms-keyof-zhin-adapters-context" aria-label="Permalink to &quot;platform(...platforms:(keyof Zhin.Adapters)[]):Context&quot;">​</a></h3><ul><li>产生一个新的上下文，该上下文传入会话<code>session.platform</code>的值存在于<code>platforms</code>中 并且满足构造函数的filter时有效</li></ul><h3 id="private-user-ids-string-number-context" tabindex="-1">private(...user_ids:(string|number)[]):Context <a class="header-anchor" href="#private-user-ids-string-number-context" aria-label="Permalink to &quot;private(...user_ids:(string|number)[]):Context&quot;">​</a></h3><ul><li>产生一个新的上下文，该上下文传入会话<code>session.user_id</code>的值存在于<code>user_ids</code>中并 且会话事件为私聊并且满足构造函数的filter时有效</li></ul><h3 id="getmatchedcontextlist-session-session-context" tabindex="-1">getMatchedContextList(session:Session):Context[] <a class="header-anchor" href="#getmatchedcontextlist-session-session-context" aria-label="Permalink to &quot;getMatchedContextList(session:Session):Context[]&quot;">​</a></h3><ul><li>根据传入会话获取匹配到的上下文列表</li></ul><h3 id="plugin-entry-string-plugin-install-setup-boolean-this-plugin" tabindex="-1">plugin(entry:string:Plugin.Install,setup?:boolean):this|Plugin <a class="header-anchor" href="#plugin-entry-string-plugin-install-setup-boolean-this-plugin" aria-label="Permalink to &quot;plugin(entry:string:Plugin.Install,setup?:boolean):this|Plugin&quot;">​</a></h3><ul><li>传入string时，若当前上下文已安装name为entry的插件，则返回插件，否则，将尝试从 已加载的模块中加载插件</li><li>传入Plugin.Install时，将在当前上下文安装对应插件</li></ul><h3 id="use-plugin-plugin-this" tabindex="-1">use(plugin:Plugin):this <a class="header-anchor" href="#use-plugin-plugin-this" aria-label="Permalink to &quot;use(plugin:Plugin):this&quot;">​</a></h3><ul><li>根据Plugin.Install在当前上下文安装对应插件</li></ul><h3 id="middleware-middleware-middleware-this" tabindex="-1">middleware（middleware:Middleware):this <a class="header-anchor" href="#middleware-middleware-middleware-this" aria-label="Permalink to &quot;middleware（middleware:Middleware):this&quot;">​</a></h3><ul><li>为当前上下文添加一个中间件</li></ul><h3 id="command-def-string-initial-string-command" tabindex="-1">command（def:string,initial?:string):Command <a class="header-anchor" href="#command-def-string-initial-string-command" aria-label="Permalink to &quot;command（def:string,initial?:string):Command&quot;">​</a></h3><h3 id="command-def-string-config-command-config-command" tabindex="-1">command（def:string,config?:Command.Config):Command <a class="header-anchor" href="#command-def-string-config-command-config-command" aria-label="Permalink to &quot;command（def:string,config?:Command.Config):Command&quot;">​</a></h3><h3 id="command-def-string-initial-string-config-command-config-command" tabindex="-1">command（def:string,initial?:string,config?:Command.Config):Command <a class="header-anchor" href="#command-def-string-initial-string-config-command-config-command" aria-label="Permalink to &quot;command（def:string,initial?:string,config?:Command.Config):Command&quot;">​</a></h3><ul><li>为当前上下文添加一个指令，并返回指令本身</li></ul><h3 id="dispatch-session-session-void" tabindex="-1">dispatch（session:Session):void <a class="header-anchor" href="#dispatch-session-session-void" aria-label="Permalink to &quot;dispatch（session:Session):void&quot;">​</a></h3><ul><li>如果session满足当前上下文的filter，则将session继续想下分发</li></ul><h3 id="sendmsg-channel-context-msgchannel-msg-element-fragment-messageret" tabindex="-1">sendMsg（channel: Context.MsgChannel, msg: Element.Fragment):MessageRet <a class="header-anchor" href="#sendmsg-channel-context-msgchannel-msg-element-fragment-messageret" aria-label="Permalink to &quot;sendMsg（channel: Context.MsgChannel, msg: Element.Fragment):MessageRet&quot;">​</a></h3><ul><li>发送一条消息给指定类型的用户</li></ul><h3 id="broadcast-channelids-channelid-channelid-content-element-fragment-promise-messageret" tabindex="-1">broadcast(channelIds: ChannelId | ChannelId[], content: Element.Fragment):Promise&lt;MessageRet[]&gt; <a class="header-anchor" href="#broadcast-channelids-channelid-channelid-content-element-fragment-promise-messageret" aria-label="Permalink to &quot;broadcast(channelIds: ChannelId | ChannelId[], content: Element.Fragment):Promise&lt;MessageRet[]&gt;&quot;">​</a></h3><ul><li>广播一条消息给指定类型的用户</li></ul><h2 id="命名空间-namespace" tabindex="-1">命名空间(Namespace) <a class="header-anchor" href="#命名空间-namespace" aria-label="Permalink to &quot;命名空间(Namespace)&quot;">​</a></h2><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">namespace</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Context</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">plugin</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Symbol</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;plugin&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">childKey</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Symbol</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;children&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">type</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">MsgChannel</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">protocol</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">keyof</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Zhin</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">Adapters</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">bot_id</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">string</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">number</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">target_id</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">string</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">number</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">target_type</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;private&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;group&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;discuss&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;guild&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">  };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">from</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">parent</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Context</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">filter</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Filter</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">ctx</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Context</span><span style="color:#E1E4E8;">(parent, filter);</span></span>
<span class="line"><span style="color:#E1E4E8;">    ctx[plugin] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> parent </span><span style="color:#F97583;">?</span><span style="color:#E1E4E8;"> parent[plugin] </span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">null</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> ctx;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">type</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Filter</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> (</span><span style="color:#FFAB70;">session</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Session</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">boolean</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">defaultFilter</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Filter</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> () </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">or</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> (</span><span style="color:#FFAB70;">ctx</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Context</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">filter</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Filter</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> ((</span><span style="color:#FFAB70;">session</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Session</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> ctx.</span><span style="color:#B392F0;">filter</span><span style="color:#E1E4E8;">(session) </span><span style="color:#F97583;">||</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">filter</span><span style="color:#E1E4E8;">(session)) </span><span style="color:#F97583;">as</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Filter</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">  };</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">not</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> (</span><span style="color:#FFAB70;">ctx</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Context</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">filter</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Filter</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> ((</span><span style="color:#FFAB70;">session</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Session</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> ctx.</span><span style="color:#B392F0;">filter</span><span style="color:#E1E4E8;">(session) </span><span style="color:#F97583;">&amp;&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">!</span><span style="color:#B392F0;">filter</span><span style="color:#E1E4E8;">(session)) </span><span style="color:#F97583;">as</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Filter</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">  };</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">and</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> (</span><span style="color:#FFAB70;">ctx</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Context</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">filter</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Filter</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> ((</span><span style="color:#FFAB70;">session</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Session</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> ctx.</span><span style="color:#B392F0;">filter</span><span style="color:#E1E4E8;">(session) </span><span style="color:#F97583;">&amp;&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">filter</span><span style="color:#E1E4E8;">(session)) </span><span style="color:#F97583;">as</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Filter</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">  };</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">namespace</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Context</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">plugin</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Symbol</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;plugin&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">childKey</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Symbol</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;children&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">type</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">MsgChannel</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">protocol</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">keyof</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Zhin</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">Adapters</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">bot_id</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">string</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">number</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">target_id</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">string</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">number</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">target_type</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;private&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;group&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;discuss&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;guild&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">  };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">from</span><span style="color:#24292E;">(</span><span style="color:#E36209;">parent</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Context</span><span style="color:#24292E;">, </span><span style="color:#E36209;">filter</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Filter</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">ctx</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Context</span><span style="color:#24292E;">(parent, filter);</span></span>
<span class="line"><span style="color:#24292E;">    ctx[plugin] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> parent </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> parent[plugin] </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">null</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> ctx;</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">type</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Filter</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> (</span><span style="color:#E36209;">session</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Session</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">boolean</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">defaultFilter</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Filter</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> () </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">or</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> (</span><span style="color:#E36209;">ctx</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Context</span><span style="color:#24292E;">, </span><span style="color:#E36209;">filter</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Filter</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> ((</span><span style="color:#E36209;">session</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Session</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> ctx.</span><span style="color:#6F42C1;">filter</span><span style="color:#24292E;">(session) </span><span style="color:#D73A49;">||</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">filter</span><span style="color:#24292E;">(session)) </span><span style="color:#D73A49;">as</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Filter</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">  };</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">not</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> (</span><span style="color:#E36209;">ctx</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Context</span><span style="color:#24292E;">, </span><span style="color:#E36209;">filter</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Filter</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> ((</span><span style="color:#E36209;">session</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Session</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> ctx.</span><span style="color:#6F42C1;">filter</span><span style="color:#24292E;">(session) </span><span style="color:#D73A49;">&amp;&amp;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">!</span><span style="color:#6F42C1;">filter</span><span style="color:#24292E;">(session)) </span><span style="color:#D73A49;">as</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Filter</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">  };</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">and</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> (</span><span style="color:#E36209;">ctx</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Context</span><span style="color:#24292E;">, </span><span style="color:#E36209;">filter</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Filter</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> ((</span><span style="color:#E36209;">session</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Session</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> ctx.</span><span style="color:#6F42C1;">filter</span><span style="color:#24292E;">(session) </span><span style="color:#D73A49;">&amp;&amp;</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">filter</span><span style="color:#24292E;">(session)) </span><span style="color:#D73A49;">as</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Filter</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">  };</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div></div>`,2),p=[e];function t(r,c,i,E,y,d){return n(),a("div",null,p)}const h=s(o,[["render",t]]);export{g as __pageData,h as default};
